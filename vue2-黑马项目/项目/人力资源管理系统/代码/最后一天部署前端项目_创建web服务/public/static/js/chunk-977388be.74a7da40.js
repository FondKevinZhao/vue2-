(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-977388be"],{"0ccb":function(e,t,r){var n=r("50c4"),a=r("1148"),i=r("1d80"),s=Math.ceil,o=function(e){return function(t,r,o){var c,l,u=String(i(t)),d=u.length,p=void 0===o?" ":String(o),f=n(r);return f<=d||""==p?u:(c=f-d,l=a.call(p,s(c/p.length)),l.length>c&&(l=l.slice(0,c)),e?u+l:l+u)}};e.exports={start:o(!1),end:o(!0)}},1148:function(e,t,r){"use strict";var n=r("a691"),a=r("1d80");e.exports="".repeat||function(e){var t=String(a(this)),r="",i=n(e);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(r+=t);return r}},1276:function(e,t,r){"use strict";var n=r("d784"),a=r("44e7"),i=r("825a"),s=r("1d80"),o=r("4840"),c=r("8aa5"),l=r("50c4"),u=r("14c3"),d=r("9263"),p=r("d039"),f=[].push,m=Math.min,g=4294967295,h=!p((function(){return!RegExp(g,"y")}));n("split",2,(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=String(s(this)),i=void 0===r?g:r>>>0;if(0===i)return[];if(void 0===e)return[n];if(!a(e))return t.call(n,e,i);var o,c,l,u=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,h=new RegExp(e.source,p+"g");while(o=d.call(h,n)){if(c=h.lastIndex,c>m&&(u.push(n.slice(m,o.index)),o.length>1&&o.index<n.length&&f.apply(u,o.slice(1)),l=o[0].length,m=c,u.length>=i))break;h.lastIndex===o.index&&h.lastIndex++}return m===n.length?!l&&h.test("")||u.push(""):u.push(n.slice(m)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var a=s(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,a,r):n.call(String(a),t,r)},function(e,a){var s=r(n,e,this,a,n!==t);if(s.done)return s.value;var d=i(e),p=String(this),f=o(d,RegExp),v=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(h?"y":"g"),w=new f(h?d:"^(?:"+d.source+")",b),x=void 0===a?g:a>>>0;if(0===x)return[];if(0===p.length)return null===u(w,p)?[p]:[];var y=0,k=0,E=[];while(k<p.length){w.lastIndex=h?k:0;var R,D=u(w,h?p:p.slice(k));if(null===D||(R=m(l(w.lastIndex+(h?0:k)),p.length))===y)k=c(p,k,v);else{if(E.push(p.slice(y,k)),E.length===x)return E;for(var O=1;O<=D.length-1;O++)if(E.push(D[O]),E.length===x)return E;k=y=R}}return E.push(p.slice(y)),E}]}),!h)},"25f0":function(e,t,r){"use strict";var n=r("6eeb"),a=r("825a"),i=r("d039"),s=r("ad6d"),o="toString",c=RegExp.prototype,l=c[o],u=i((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=o;(u||d)&&n(RegExp.prototype,o,(function(){var e=a(this),t=String(e.source),r=e.flags,n=String(void 0===r&&e instanceof RegExp&&!("flags"in c)?s.call(e):r);return"/"+t+"/"+n}),{unsafe:!0})},"2c3e":function(e,t,r){var n=r("83ab"),a=r("9f7f").UNSUPPORTED_Y,i=r("9bf2").f,s=r("69f3").get,o=RegExp.prototype;n&&a&&i(RegExp.prototype,"sticky",{configurable:!0,get:function(){if(this!==o){if(this instanceof RegExp)return!!s(this).sticky;throw TypeError("Incompatible receiver, RegExp required")}}})},"4d63":function(e,t,r){var n=r("83ab"),a=r("da84"),i=r("94ca"),s=r("7156"),o=r("9bf2").f,c=r("241c").f,l=r("44e7"),u=r("ad6d"),d=r("9f7f"),p=r("6eeb"),f=r("d039"),m=r("69f3").set,g=r("2626"),h=r("b622"),v=h("match"),b=a.RegExp,w=b.prototype,x=/a/g,y=/a/g,k=new b(x)!==x,E=d.UNSUPPORTED_Y,R=n&&i("RegExp",!k||E||f((function(){return y[v]=!1,b(x)!=x||b(y)==y||"/a/i"!=b(x,"i")})));if(R){var D=function(e,t){var r,n=this instanceof D,a=l(e),i=void 0===t;if(!n&&a&&e.constructor===D&&i)return e;k?a&&!i&&(e=e.source):e instanceof D&&(i&&(t=u.call(e)),e=e.source),E&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,"")));var o=s(k?new b(e,t):b(e,t),n?this:w,D);return E&&r&&m(o,{sticky:r}),o},O=function(e){e in D||o(D,e,{configurable:!0,get:function(){return b[e]},set:function(t){b[e]=t}})},j=c(b),_=0;while(j.length>_)O(j[_++]);w.constructor=D,D.prototype=w,p(a,"RegExp",D)}g("RegExp")},"4d90":function(e,t,r){"use strict";var n=r("23e7"),a=r("0ccb").start,i=r("9a0c");n({target:"String",proto:!0,forced:i},{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"542f":function(e,t,r){"use strict";r("ec2a")},7156:function(e,t,r){var n=r("861d"),a=r("d2bb");e.exports=function(e,t,r){var i,s;return a&&"function"==typeof(i=t.constructor)&&i!==r&&n(s=i.prototype)&&s!==r.prototype&&a(e,s),e}},"7db0":function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").find,i=r("44d2"),s=r("ae40"),o="find",c=!0,l=s(o);o in[]&&Array(1)[o]((function(){c=!1})),n({target:"Array",proto:!0,forced:c||!l},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i(o)},"9a0c":function(e,t,r){var n=r("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},ec2a:function(e,t,r){},ed08:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0");r("ac1f"),r("00b4"),r("5319"),r("4d63"),r("2c3e"),r("25f0"),r("4d90"),r("1276"),r("159b");function n(e,t){var r=[];return e.forEach((function(a){if(a.pid===t){var i=n(e,a.id);i.length&&(a.children=i),r.push(a)}})),r}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=new Date(24*(e-25567)*36e5-3e5-43e3-864e5-288e5);r.setYear(r.getFullYear());var n=r.getFullYear()+"",a=r.getMonth()+1+"",i=r.getDate()+"";return t&&1===t.length?n+t+a+t+i:n+(a<10?"0"+a:a)+(i<10?"0"+i:i)}},fb3b:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"departments-container"},[r("div",{staticClass:"app-container"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{staticClass:"tab-pane",attrs:{label:"组织导航",name:"first"}},[r("el-row",{staticClass:"department-header",attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("el-col",{attrs:{span:20}},[r("i",{staticClass:"el-icon-s-home"}),r("span",{staticClass:"company"},[e._v("江苏传智播客教育科技股份有限公司")])]),r("el-col",{attrs:{span:4}},[r("el-row",{attrs:{type:"flex",justify:"end"}},[r("el-col",[e._v("负责人")]),r("el-col",[r("el-dropdown",[r("span",{staticClass:"el-dropdown-link"},[e._v(" 操作"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{nativeOn:{click:function(t){return e.add()}}},[e._v("添加子部门")])],1)],1)],1)],1)],1)],1),r("el-tree",{staticClass:"departments-tree",attrs:{data:e.treeData,props:e.defaultProps,"default-expand-all":!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return[r("el-row",{staticStyle:{height:"40px",width:"100%"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("el-col",{attrs:{span:20}},[r("span",[e._v(e._s(n.name))])]),r("el-col",{attrs:{span:4}},[r("el-row",{attrs:{type:"flex",justify:"end"}},[r("el-col",[e._v(e._s(n.manager))]),r("el-col",[r("el-dropdown",[r("span",[e._v(" 操作"),r("i",{staticClass:"el-icon-arrow-down"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{nativeOn:{click:function(t){return e.add(n)}}},[e._v("添加子部门")]),r("el-dropdown-item",{nativeOn:{click:function(t){return e.edit(n)}}},[e._v("编辑部门")]),n&&!n.children?r("el-dropdown-item",{nativeOn:{click:function(t){return e.del(n)}}},[e._v("删除部门")]):e._e()],1)],1)],1)],1)],1)],1)]}}])})],1)],1)],1)])],1),r("departDialog",{ref:"dialog",attrs:{"dialog-visible":e.showDialog,"parent-id":e.parentId,"is-edit":e.isEdit,"origin-list":e.originList},on:{closeDialog:e.closeDialogFn}})],1)},a=[],i=r("1da1"),s=(r("d81d"),r("b0c0"),r("96cf"),r("365c")),o=r("ed08"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:e.isEdit?"编辑子部门":"添加子部门",visible:e.dialogVisible,width:"50%","before-close":e.handleClose,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"deptForm",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[r("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"1-50个字符"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"部门编码",prop:"code"}},[r("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"1-50个字符"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),r("el-form-item",{attrs:{label:"部门负责人",prop:"manager"}},[r("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择"},model:{value:e.form.manager,callback:function(t){e.$set(e.form,"manager",t)},expression:"form.manager"}},e._l(e.employeeList,(function(e){return r("el-option",{key:e.id,attrs:{value:e.username}})})),1)],1),r("el-form-item",{attrs:{label:"部门介绍",prop:"introduce"}},[r("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"1-300个字符",type:"textarea",rows:3},model:{value:e.form.introduce,callback:function(t){e.$set(e.form,"introduce",t)},expression:"form.introduce"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelFn}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.enterFn}},[e._v("确 定")])],1)],1)],1)},l=[],u=r("5530"),d=(r("4de4"),r("d3b7"),r("caad"),r("2532"),r("7db0"),{props:{dialogVisible:{type:Boolean,default:!1},parentId:{type:String,required:!0},isEdit:{type:Boolean},originList:{type:Array,default:function(){return[]},required:!0}},data:function(){var e=this,t=function(t,r,n){var a=e.originList.map((function(e){return e.code}));e.isEdit&&(a=e.originList.filter((function(t){return t.id!==e.parentId})).map((function(e){return e.code}))),a.includes(r)?n(new Error("编码"+r+"已经存在")):n()},r=function(t,r,n){var a=e.originList.filter((function(t){return t.pid===e.parentId})).map((function(e){return e.name}));if(e.isEdit){var i=e.originList.find((function(t){return t.id===e.parentId})),s=i.pid;a=e.originList.filter((function(t){return t.pid===s&&t.id!==e.parentId})).map((function(e){return e.name}))}a.includes(r)?n(new Error("名字"+r+"已经被占用了")):n()};return{form:{name:"",code:"",manager:"",introduce:""},employeeList:[],rules:{name:[{required:!0,message:"部门名称不能为空",trigger:"blur"},{min:1,max:50,message:"部门名称要求1-50个字符",trigger:"blur"},{validator:r,trigger:"blur"}],code:[{required:!0,message:"部门编码不能为空",trigger:"blur"},{min:1,max:50,message:"部门编码要求1-50个字符",trigger:"blur"},{validator:t,trigger:"blur"}],manager:[{required:!0,message:"部门负责人不能为空",trigger:"blur"}],introduce:[{required:!0,message:"部门介绍不能为空",trigger:"blur"},{min:1,max:300,message:"部门介绍要求1-300个字符",trigger:"blur"}]}}},watch:{isEdit:function(){console.log(this.isEdit),this.isEdit&&this.getDepartmentDetailFn()}},created:function(){this.getEmployeesListFn()},methods:{handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},cancelFn:function(){this.$emit("closeDialog")},enterFn:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.deptForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=17;break}if(!e.isEdit){t.next=10;break}return t.next=4,Object(s["z"])(Object(u["a"])(Object(u["a"])({},e.form),{},{pid:e.parentId}));case 4:if(n=t.sent,n.success){t.next=7;break}return t.abrupt("return",e.$message.error(n.message));case 7:e.$message.success(n.message),t.next=16;break;case 10:return t.next=12,Object(s["a"])(Object(u["a"])(Object(u["a"])({},e.form),{},{pid:e.parentId}));case 12:if(a=t.sent,a.success){t.next=15;break}return t.abrupt("return",e.$message.error(a.message));case 15:e.$message.success(a.message);case 16:e.$emit("closeDialog");case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},getEmployeesListFn:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["o"])();case 2:r=t.sent,console.log(r),e.employeeList=r.data;case 5:case"end":return t.stop()}}),t)})))()},getDepartmentDetailFn:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["m"])(e.parentId);case 2:r=t.sent,console.log(r),e.form=r.data;case 5:case"end":return t.stop()}}),t)})))()}}}),p=d,f=r("2877"),m=Object(f["a"])(p,c,l,!1,null,null,null),g=m.exports,h={name:"Departments",components:{departDialog:g},data:function(){return{activeName:"first",treeData:[{departName:"总裁办",name:"孙财"},{departName:"行政部",name:"罗晓晓"},{departName:"人事部",name:"安小晴",children:[{departName:"财务核算部"}]},{departName:"财务部",name:"",children:[{departName:"财务核算部"},{departName:"税务管理部"},{departName:"薪资管理部"}]},{departName:"技术部",name:"",children:[{departName:"前端技术部"},{departName:"后端技术部"}]},{departName:"运营部",name:""},{departName:"市场部",name:"武高丽",children:[{departName:"市场部1"},{departName:"市场部2"}]}],defaultProps:{label:"name"},showDialog:!1,parentId:"",isEdit:!1,originList:[]}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getDepartmentsListFn();case 1:case"end":return t.stop()}}),t)})))()},methods:{add:function(e){this.parentId=e?e.id:"",this.showDialog=!0},edit:function(e){this.parentId=e.id,this.showDialog=!0,this.isEdit=!0},del:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(n=r.sent,"cancel"!==n){r.next=5;break}return r.abrupt("return",t.$message("您取消了删除"));case 5:return r.next=7,Object(s["g"])(e.id);case 7:if(a=r.sent,a.success){r.next=10;break}return r.abrupt("return",t.$message.error(a.message));case 10:t.$message.success(a.message),t.getDepartmentsListFn();case 12:case"end":return r.stop()}}),r)})))()},getDepartmentsListFn:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["k"])();case 2:r=t.sent,e.treeData=Object(o["b"])(r.data.depts,""),e.originList=r.data.depts.map((function(e){return{id:e.id,code:e.code,name:e.name,pid:e.pid}}));case 5:case"end":return t.stop()}}),t)})))()},closeDialogFn:function(){this.showDialog=!1,this.isEdit=!1,this.getDepartmentsListFn(),this.$refs.dialog.$refs.deptForm.resetFields()}}},v=h,b=(r("542f"),Object(f["a"])(v,n,a,!1,null,"a6d8fdec",null));t["default"]=b.exports}}]);